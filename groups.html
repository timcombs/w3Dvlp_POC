<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" name="viewport" content="width=device-width, initial-scale=1">
  <title>w3Develops Groups Display</title>
</head>

<body>
  <header>some info about what is on this page</header>
  <nav>navigation links</nav>

  <!-- will programmatically add groups to each section -->
  <section id="study-groups">Study Groups</section>
  <section id="build-groups">Build Groups</section>

  <footer>info and links</footer>

  <script>
    // TODO: do we need to hide the links to the page?
    // private key stuff - check into this
    // write up a blog post about this procedure - reference other websites:
    // https://coderwall.com/p/duapqq/use-a-google-spreadsheet-as-your-json-backend
    // https://stackoverflow.com/questions/24531351/retrieve-google-spreadsheet-worksheet-json
    const studyLink = 'https://spreadsheets.google.com/feeds/list/1PMWsPEfHFC6myMwhdidyr2hhRK5ZA-JrDQzwRoDTFaw/oua1i2d/public/values?alt=json-in-script&callback=text';
    const studyGroups = document.querySelector('#study-groups');
    const buildGroups = document.querySelector('#build-groups');
    
    const studyGroupArr = grabGroup(studyLink);
    // const buildGroupArr = grabGroup(studyLink);

    console.log(studyGroupArr);

    function grabGroup(link) {
      return fetch(link, { headers: {'Content-Type': 'text/plain; charset=utf-8'} })
        .then((blob) => blob.text())
        .then((text) => {
          let sheetText = text.replace('// API callback\ntext(', '')
                              .replace(');', '');
          let groupObj = JSON.parse(sheetText);
          groupArr = groupObj.feed.entry;
          return groupArr
        })
        .catch((err) => {
          console.log('error', err);
          alert('sorry, we have no bananas.')
        }
      );
    }

  </script>

</body>

</html>